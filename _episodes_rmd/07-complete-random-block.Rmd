---
title: "Randomized Complete Block Designs"
teaching: 0
exercises: 0
questions:
- "What is randomized complete block design?"
objectives:
- "A randomized complete block design randomizes treatments to experimental units within the block."
- "Blocking increases the precision of treatment comparisons."
keypoints:
- "Replication, randomization and blocking determine the validity and usefulness of an experiment."
source: Rmd
---

```{r, include = FALSE}
source("../bin/chunk-options.R")
knitr_fig_path("03-")
```


## Design issues

Imagine that you want to evaluate the effect of different 
doses of a new drug on the proliferation of cancer cell lines in vitro. You use
four different cancer cell lines because you would like the results to 
generalize to many types of cell lines. Divide each of the cell lines into four 
treatment groups, each with the same number of cells. Each treatment group
receives a different dose of the drug for five consecutive days.

Group 1: Control (no drug)  
Group 2: Low dose (10 μM) 
Group 3: Medium dose (50 μM) 
Group 4: High dose (100 μM) 

```{r, complete_random_block}

# create treatment levels
f <- factor(c("control", "low", "medium", "high"))

# create random orderings of the treatment levels
block1 <- sample(f, 4)
block2 <- sample(f, 4)
block3 <- sample(f, 4)
block4 <- sample(f, 4)
treatment <- c(block1, block2, block3, block4)
block <- factor(rep(c("cellLine1", "cellLine2", "cellLine3", "cellLine4"), each = 4))
dishnum <- rep(1:4, 4)
plan <- data.frame(cellLine = block, DishNumber = dishnum, treatment = treatment)
plan
```

When analyzing a random complete block design, the effect of the block is 
included in the equation along with the effect of the treatment. 

## Randomized block design with a single replication


```{r, random_number_generator}
exp_unit <- LETTERS
random_number <- sample(x = 100, size = 26)

# %% is the modulo operator, which returns the remainder from division
treatment <- ifelse(random_number %% 2 == 0, "chow", "high fat")
random_allocation <- data.frame(exp_unit, random_number, treatment)
random_allocation
```

## Sizing a randomized block experiment

```{r, write_out_plan}
write.csv(equal_allocation, file = "random-assign.csv", row.names = FALSE)
```
> ## Discussion
> Why not assign treatment and control groups to samples in alphabetical order?  
> Did we really need a random number generator to obtain randomized equal groups?
>
> >
> > ## Solution 
> > 
> > 1). Scenario: One technician processed samples A through M, and a different 
> > technician processed samples N through Z.  
> > 2). Another scenario: Samples A through M were processed on a Monday, and 
> > samples N through Z on a Tuesday.  
> > 3). Yet another scenario: Samples A through M were from one strain, and 
> > samples N through Z from a different strain.    
> > 4). Yet another scenario: Samples with consecutive ids were all sibling 
> > groups. For example, samples A, B and C were all siblings, and all assigned 
> > to the same treatment.  
> > All of these cases would have introduced an effect (from the technician, the 
> > day of the week, the strain, or sibling relationships) that would confound 
> > the results and lead to misinterpretation.
> > 
> {: .solution}
{: .challenge}

## True replication

## Balanced incomplete block designs

{% include links.md %}