---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 04-statistical-data-analysis.md in _episodes_rmd/
title: "Statistics in Data Analysis"
teaching: 0
exercises: 0
questions:
- "How can information be extracted and communicated from experimental data?"
objectives:
- "Plotting reveals information in the data."
- "Statistical significance testing compares experimental data obtained to probability distributions of data that might also be possible."
- "A probability distribution is a mathematical function that gives the probabilities of different possible outcomes for an experiment."
keypoints:
- "Plotting and significance testing describe patterns in the data and quantify effects against random variation."
source: Rmd
---



## The first step in data analysis: plot the data!
A picture is worth a thousand words, and a picture of your data could reveal
important information that can guide you forward. So first, plot the data!


~~~
# simulate Generation 100 resting heart rate data for the 1,567 study 
# participants
# rnorm() generates a random normal distribution from the mean and standard
# deviation values you provide
simulated_heart_rates <- rnorm(n = 1567, mean = 80, sd = 10)
hist(simulated_heart_rates, xlab = "resting heart rate")
~~~
{: .language-r}

<img src="../fig/rmd-03-simulate_gen100_data-1.png" alt="plot of chunk simulate_gen100_data" width="612" style="display: block; margin: auto;" />
## A picture is worth a thousand words

> ## Exercise 1: What does this picture tell you about resting heart rates?  
> Are there gaps in the data?  
> Are there large clusters of similar heart rate values in the data?  
> Are there apparent outliers?  
> Do the left and right tails of the data seem to mirror each other or not?
> >
> > ## Solution to Exercise 1
> > 
> > 
> > 
> {: .solution}
{: .challenge}

Now create a boxplot of the same data.


~~~
boxplot(simulated_heart_rates)
~~~
{: .language-r}

<img src="../fig/rmd-03-boxplot_simulated_gen100_data-1.png" alt="plot of chunk boxplot_simulated_gen100_data" width="612" style="display: block; margin: auto;" />

> ## Exercise 2: What does this boxplot tell you about resting heart rates?  
> What does the box signify?  
> What does horizontal black line dividing the box signify?  
> Are there apparent outliers?  
> How does the boxplot relate to the histogram?
> >
> > ## Solution to Exercise 2
> > 
> > 
> > 
> {: .solution}
{: .challenge}
## Plotting



~~~
exp_unit <- LETTERS
random_number <- sample(x = 100, size = 26)

# %% is the modulo operator, which returns the remainder from division
treatment <- ifelse(random_number %% 2 == 0, "chow", "high fat")
random_allocation <- data.frame(exp_unit, random_number, treatment)
random_allocation
~~~
{: .language-r}



~~~
   exp_unit random_number treatment
1         A            72      chow
2         B            34      chow
3         C            96      chow
4         D            97  high fat
5         E            81  high fat
6         F            57  high fat
7         G            49  high fat
8         H            44      chow
9         I            23  high fat
10        J            73  high fat
11        K            80      chow
12        L            18      chow
13        M            85  high fat
14        N            25  high fat
15        O            94      chow
16        P            22      chow
17        Q            36      chow
18        R            82      chow
19        S            48      chow
20        T            11  high fat
21        U            31  high fat
22        V            76      chow
23        W            69  high fat
24        X             6      chow
25        Y            62      chow
26        Z            65  high fat
~~~
{: .output}




~~~
table(random_allocation$treatment)
~~~
{: .language-r}



~~~

    chow high fat 
      14       12 
~~~
{: .output}




~~~
# place IDs and random numbers in data frame
equal_allocation <- data.frame(exp_unit, random_number)

# sort by random numbers (not by sample IDs)
equal_allocation <- equal_allocation[order(random_number),]

# now assign to treatment or control groups
treatment <- sort(rep(x = c("chow", "high fat"), times = 13))
equal_allocation <- cbind(equal_allocation, treatment)
row.names(equal_allocation) <- 1:26
equal_allocation
~~~
{: .language-r}



~~~
   exp_unit random_number treatment
1         X             6      chow
2         T            11      chow
3         L            18      chow
4         P            22      chow
5         I            23      chow
6         N            25      chow
7         U            31      chow
8         B            34      chow
9         Q            36      chow
10        H            44      chow
11        S            48      chow
12        G            49      chow
13        F            57      chow
14        Y            62  high fat
15        Z            65  high fat
16        W            69  high fat
17        A            72  high fat
18        J            73  high fat
19        V            76  high fat
20        K            80  high fat
21        E            81  high fat
22        R            82  high fat
23        M            85  high fat
24        O            94  high fat
25        C            96  high fat
26        D            97  high fat
~~~
{: .output}



~~~
write.csv(equal_allocation, file = "random-assign.csv", row.names = FALSE)
~~~
{: .language-r}
> ## Discussion
> Why not assign treatment and control groups to samples in alphabetical order?  
> Did we really need a random number generator to obtain randomized equal groups?
>
> >
> > ## Solution 
> > 
> > 1). Scenario: One technician processed samples A through M, and a different 
> > technician processed samples N through Z.  
> > 2). Another scenario: Samples A through M were processed on a Monday, and 
> > samples N through Z on a Tuesday.  
> > 3). Yet another scenario: Samples A through M were from one strain, and 
> > samples N through Z from a different strain.    
> > 4). Yet another scenario: Samples with consecutive ids were all sibling 
> > groups. For example, samples A, B and C were all siblings, and all assigned 
> > to the same treatment.  
> > All of these cases would have introduced an effect (from the technician, the 
> > day of the week, the strain, or sibling relationships) that would confound 
> > the results and lead to misinterpretation.
> > 
> {: .solution}
{: .challenge}

## Statistical significance testing

## Probability and distributions

## The perils of p-values

## The t-test

## Confidence intervals

## Sample sizes and power curves

## Comparing standard deviations


{% include links.md %}
