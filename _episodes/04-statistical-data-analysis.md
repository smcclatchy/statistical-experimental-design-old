---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 04-statistical-data-analysis.md in _episodes_rmd/
title: "Statistics in Data Analysis"
teaching: 0
exercises: 0
questions:
- "How can information be extracted and communicated from experimental data?"
objectives:
- "Plotting reveals information in the data."
- "Statistical significance testing compares experimental data obtained to probability distributions of data that might also be possible."
- "A probability distribution is a mathematical function that gives the probabilities of different possible outcomes for an experiment."
keypoints:
- "Plotting and significance testing describe patterns in the data and quantify effects against random variation."
source: Rmd
---



## A picture is worth a thousand words

To motivate this next section on statistics, we start with an example of human
variability. This 1975 living histogram of female students from the University 
of Wisconsin Madison shows variability in a natural population.

![living histogram of female student heights](../fig/joiner-living-histogram-heights.png)

[B. Joiner, Int'l Stats Review, 1975](https://personal.psu.edu/drh20/talks/joiner_living_histograms.pdf)

> ## Exercise 1: A living histogram
> From the living histogram, can you estimate by eye  
> 1). the mean and median heights?  
> 2). the spread of the data? Estimate either standard deviation or variance. If
> you're not sure about how to do this, think about how you would describe the
> spread of the data from the mean rather than calculating a statistic.
> 3). any outliers? Estimate by eye - don't worry about calculations.  
> 4). What do you predict would happen to mean, median, spread and outliers if
> an equal number of men were added to the histogram?
>
> >
> > ## Solution to Exercise 1
> > 
> > 1).  
> > 2). 
> > 3).   
> > 4). 
> > 
> {: .solution}
{: .challenge}

## The first step in data analysis: plot the data!
A picture is worth a thousand words, and a picture of your data could reveal
important information that can guide you forward. So first, plot the data!


~~~
# simulate Generation 100 resting heart rate data for the 1,567 study 
# participants
# rnorm() generates a random normal distribution from the mean and standard
# deviation values you provide
simulated_heart_rates <- rnorm(n = 1567, mean = 80, sd = 10)

# take a sample of 100 and create a histogram
# first set the seed for the random number generator
set.seed(42)
sample100 <- sample(simulated_heart_rates, 100)
hist(sample100, xlab = "resting heart rate for 100 participants")
~~~
{: .language-r}

<div class="figure" style="text-align: center">
<img src="../fig/rmd-03-simulate_gen100_data-1.png" alt="plot of chunk simulate_gen100_data" width="612" />
<p class="caption">plot of chunk simulate_gen100_data</p>
</div>

> ## Exercise 1: What does this picture tell you about resting heart rates?  
> Do the data appear to be normally distributed? Why does this matter?  
> Do the left and right tails of the data seem to mirror each other or not?  
> Are there gaps in the data?  
> Are there large clusters of similar heart rate values in the data?  
> Are there apparent outliers?  
> What message do the data deliver in this histogram?  
> >
> > ## Solution to Exercise 1
> > 
> > 
> > 
> {: .solution}
{: .challenge}

Now create a boxplot of the same sample data.


~~~
boxplot(sample100)
~~~
{: .language-r}

<div class="figure" style="text-align: center">
<img src="../fig/rmd-03-boxplot_simulated_gen100_data-1.png" alt="plot of chunk boxplot_simulated_gen100_data" width="612" />
<p class="caption">plot of chunk boxplot_simulated_gen100_data</p>
</div>

> ## Exercise 2: What does this boxplot tell you about resting heart rates?  
> What does the box signify?  
> What does horizontal black line dividing the box signify?  
> Are there apparent outliers?  
> How does the boxplot relate to the histogram?
> What message do the data deliver in this boxplot?  
> >
> > ## Solution to Exercise 2
> > 
> > 
> > 
> {: .solution}
{: .challenge}

Plotting the data can reveal relationships between variables, identify unusual 
response measurements (**outliers**) and guide further statistical analysis.
When data are not normally distributed (bell-shaped and symmetrical), many of 
the statistical methods typically used will not perform well. In these cases
the data can be transformed to a more symmetrical bell-shaped curve.

## Statistical significance testing
The Generation 100 studied aims to determine whether high-intensity exercise in
elderly adults affects lifespan and healthspan. A substudy looked at whether
cardiorespiratory fitness, the supply of oxygen to skeletal muscles, is linked 
to high blood volume in the elderly. It is well known that physical activity can increase blood volume and that high blood volume is crucial to athletic 
performance, however, this is the first study to demonstrate this relationship 
in elderly people.

To test whether exercise affects blood volume, 50 volunteers from the Generation 
100 participants were [placed in two groups](https://frontiersin.org/articles/10.3389/fspor.2021.638139/full) 
- fit or unfit - depending on results of peak oxygen uptake testing. Exercise
was objectively measured with a wearable sensor for one week between peak 
oxygen testing and blood volume measurements. Simulated data are shown below.



> ## Exercise 3: Comparing two groups
> Does there appear to be a significant blood volume difference between the 
> two groups? How would you know?   
> Do any of the data overlap between the two boxplots?  
> >
> > ## Solution to Exercise 3
> > 
> > 
> > 
> {: .solution}
{: .challenge}

## The t-test
What does it mean that a difference is statistically significant? We can eye
plots like the one above and see a difference, however, we need something more 
objective than eyeballs to claim a significant difference. 



## Probability and probability distributions
Suppose you have measured the resting heart rate of the entire population of 
people who are 70 or older, not just the 1,567 from the Generation 100 study. 
Imagine you need to describe these numbers to someone who has no idea what 
resting heart rate is. Suppose all the measurements are contained in 
`simulated_heart_rates`. We could list out all of the numbers for them to see or 
take a sample and show them the sample, but this would be inefficient and 
wouldn't provide much insight into the data. A better approach is to define and 
visualize a **distribution**. The simplest way to think of a distribution is as 
a compact description of many numbers. 

Histograms show us the proportion of values within an interval. Here is a 
histogram showing all resting heart rates.



Showing this plot is much more informative and easier to interpret than a long
table of numbers. With this histogram we can approximate the number of 
individuals in any given interval. For example, there are approximately
30 individuals (~2%) with a resting heart rate greater than 100. The 
probability distribution we see above approximates one that is very common in 
nature: the bell curve, also known as the **normal distribution** or Gaussian
distribution.



The curve shown above is an example of a **probability density function** that
defines a bell-shaped curve. The y-axis is the **probability density**. 
Statistical convention denotes a variable that has a standard normal 
distribution by *z*. The total area under the curve sums to 1.0. If you draw a
random value from a normal distribution, the probability that the value falls in
a particular interval, say from a to b, is given by the area under the curve
between a and b. Software can be used to calculate these probabilities.

When the histogram of a list of numbers approximates the normal distribution, 
we can use a convenient mathematical formula to approximate the proportion of 
values or outcomes in any given interval. Real-world populations may be 
approximated by the mathematical ideal of the normal distribution. Repeat the
sampling we did earlier and produce a new histogram of the sample.


~~~
sample100 <- sample(simulated_heart_rates, 100)
hist(sample100, xlab = "resting heart rate for 100 participants")
~~~
{: .language-r}

<div class="figure" style="text-align: center">
<img src="../fig/rmd-03-sample_hist-1.png" alt="plot of chunk sample_hist" width="612" />
<p class="caption">plot of chunk sample_hist</p>
</div>

> ## Exercise 4: Sampling from a population
> Does the sample appear to be normally distributed?   
> Can you estimate the mean resting heart rate by eye?  
> What is the sample mean using R?  
> Can you estimate the sample standard deviation by eye? Hint: if normally 
> distributed, 68% of the data will lie within one standard deviation of the 
> mean and 95% will lie within 2 standard deviations.
> What is the sample standard deviation using R?  
> What message does the sample deliver about the population from which it was
> drawn?  
> >
> > ## Solution to Exercise 4
> > 
> > 
> > 
> {: .solution}
{: .challenge}

## The perils of p-values

## Confidence intervals

## Sample sizes and power curves

## Comparing standard deviations


{% include links.md %}
