---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 04-statistical-data-analysis.md in _episodes_rmd/
title: "Statistics in Data Analysis"
teaching: 0
exercises: 0
questions:
- "How can information be extracted and communicated from experimental data?"
objectives:
- "Plotting the data reveals information in the data."
- "Statistical significance testing compares experimental data obtained to probability distributions of data that might also be possible."
- "A probability distribution is a mathematical function that gives the probabilities of different possible outcomes for an experiment."
keypoints:
- "Plotting and significance testing describe patterns in the data and quantify effects against random variation."
source: Rmd
---



Variability is natural in the real world. A medication given to a group of 
patients will affect each of them differently. A specific diet given to a cage
of mice will affect each mouse differently. Ideally if something is measured 
many times, each measurement will give exactly the same result and will 
represent the true value. This ideal doesn't exist in the real world. For 
example, the mass of one kilogram is defined by the International Prototype 
Kilogram, a cylinder composed of platinum and iridium. Copies of this prototype kilogram (replicates) are distributed worldwide and are regularly compared to 
the original to ensure the standard mass of one kilogram. None of the copies of 
the prototype measure precisely the same despite careful storage and handling. 
The reasons for this variation in measurements is not known.

## the experiment

> ## Exercise 1: Which kind of error?
> A study used to determine the effect of a drug on weight loss 
> could have the following sources of experimental error. 
> Classify the following sources as either biological, 
> systematic, or random error.  
> 1). A scale is broken and provides inconsistent readings.  
> 2). A scale is calibrated wrongly and consistently measures mice 1 gram heavier.   
> 3). A mouse has an unusually high weight compared to its experimental group (i.e., it is an outlier).  
> 4). Strong atmospheric low pressure and accompanying storms affect instrument readings, animal behavior, and indoor relative humidity.  
>
> >
> > ## Solution to Exercise 1
> > 
> > 1). random, because the scale is broken and provides any kind of random reading it comes up with (inconsistent reading)  
> > 2). systematic  
> > 3). biological  
> > 4). random or systematic; you argue which and explain why
> > 
> {: .solution}
{: .challenge}

## Plotting



~~~
exp_unit <- LETTERS
random_number <- sample(x = 100, size = 26)

# %% is the modulo operator, which returns the remainder from division
treatment <- ifelse(random_number %% 2 == 0, "chow", "high fat")
random_allocation <- data.frame(exp_unit, random_number, treatment)
random_allocation
~~~
{: .language-r}



~~~
   exp_unit random_number treatment
1         A            96      chow
2         B            64      chow
3         C            10      chow
4         D            72      chow
5         E            89  high fat
6         F            67  high fat
7         G           100      chow
8         H            38      chow
9         I            19  high fat
10        J            31  high fat
11        K            30      chow
12        L             2      chow
13        M            43  high fat
14        N            68      chow
15        O            82      chow
16        P            99  high fat
17        Q            14      chow
18        R            61  high fat
19        S            92      chow
20        T            54      chow
21        U            37  high fat
22        V            13  high fat
23        W            97  high fat
24        X            16      chow
25        Y            71  high fat
26        Z            42      chow
~~~
{: .output}




~~~
table(random_allocation$treatment)
~~~
{: .language-r}



~~~

    chow high fat 
      15       11 
~~~
{: .output}




~~~
# place IDs and random numbers in data frame
equal_allocation <- data.frame(exp_unit, random_number)

# sort by random numbers (not by sample IDs)
equal_allocation <- equal_allocation[order(random_number),]

# now assign to treatment or control groups
treatment <- sort(rep(x = c("chow", "high fat"), times = 13))
equal_allocation <- cbind(equal_allocation, treatment)
row.names(equal_allocation) <- 1:26
equal_allocation
~~~
{: .language-r}



~~~
   exp_unit random_number treatment
1         L             2      chow
2         C            10      chow
3         V            13      chow
4         Q            14      chow
5         X            16      chow
6         I            19      chow
7         K            30      chow
8         J            31      chow
9         U            37      chow
10        H            38      chow
11        Z            42      chow
12        M            43      chow
13        T            54      chow
14        R            61  high fat
15        B            64  high fat
16        F            67  high fat
17        N            68  high fat
18        Y            71  high fat
19        D            72  high fat
20        O            82  high fat
21        E            89  high fat
22        S            92  high fat
23        A            96  high fat
24        W            97  high fat
25        P            99  high fat
26        G           100  high fat
~~~
{: .output}



~~~
write.csv(equal_allocation, file = "random-assign.csv", row.names = FALSE)
~~~
{: .language-r}
> ## Discussion
> Why not assign treatment and control groups to samples in alphabetical order?  
> Did we really need a random number generator to obtain randomized equal groups?
>
> >
> > ## Solution 
> > 
> > 1). Scenario: One technician processed samples A through M, and a different 
> > technician processed samples N through Z.  
> > 2). Another scenario: Samples A through M were processed on a Monday, and 
> > samples N through Z on a Tuesday.  
> > 3). Yet another scenario: Samples A through M were from one strain, and 
> > samples N through Z from a different strain.    
> > 4). Yet another scenario: Samples with consecutive ids were all sibling 
> > groups. For example, samples A, B and C were all siblings, and all assigned 
> > to the same treatment.  
> > All of these cases would have introduced an effect (from the technician, the 
> > day of the week, the strain, or sibling relationships) that would confound 
> > the results and lead to misinterpretation.
> > 
> {: .solution}
{: .challenge}

## Statistical significance testing

## Probability and distributions

## The perils of p-values

## The t-test

## Confidence intervals

## Sample sizes and power curves

## Comparing standard deviations


{% include links.md %}
